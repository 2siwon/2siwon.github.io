---
layout: post
title:  "SQL : 02. 문법(3)"
date:   2017-10-7 15:10:41 +0900
categories: SQL
---

**SELECT TOP** SELECT TOP 절은 리턴될 레코드의 수를 정할 수 있다.<br>
SELECT TOP 절은 수천 개의 레코드가있는 큰 테이블에서 유용하다. 많은 수의 레코드를 반환하면 성능에 영향을 줄 수 있다.

> 모든 데이터베이스 시스템이 **SELECT TOP** 절을 지원하는 것은 아니다. MySQL은 **LIMIT** 절, Oracle 은 **ROWNUM** 을 사용한다.

SQL Server / MS Access 문법:

```sql
SELECT TOP number|percent column_name(s)
FROM table_name
WHERE condition;
```

MySQL 문법:

```sql
SELECT column_name(s)
FROM table_name
WHERE condition
LIMIT number;
```

Oracle 문법:

```sql
SELECT column_name(s)
FROM table_name
WHERE ROWNUM <= number;
```

Customer 테이블

![selecttop](../../../../assets/media/images/sql-004/selecttop00.png)
###### 출처 - https://www.w3schools.com/sql/sql_top.asp

Customers 테이블에서 처음 세 개의 레코드를 선택하는 sql문을 작성을하면 아래와 같다.<br>

SELECT TOP

```sql
SELECT TOP 3 * FROM Customers;
```

LIMIT

```sql
SELECT * FROM Customers
LIMIT 3;
```

ROWNUM

```sql
SELECT * FROM Customers
WHERE ROWNUM <= 3;
```

SELECT TOP 절은 원하는 레코드의 개수를 **PERCENT** 로도 리턴받을 수 있다.

```sql
SELECT TOP 50 PERCENT * FROM Customers;
```

**WHERE** 절을 추가해서 사용 할 수도 있다.

SELECT TOP

```sql
SELECT TOP 3 * FROM Customers
WHERE Country='Germany';
```

LIMIT

```sql
SELECT * FROM Customers
WHERE Country='Germany'
LIMIT 3;
```

ROWNUM

```sql
SELECT * FROM Customers
WHERE Country='Germany' AND ROWNUM <= 3;
```

<br><br><br><br>


**function : MIN(), MAX()** 각각 컬럼에서 최소값과 최대값을 리턴한다.

MIN() 문법:

```sql
SELECT MIN(column_name)
FROM table_name
WHERE condition;
```

MAX() 문법:

```sql
SELECT MAX(column_name)
FROM table_name
WHERE condition;
```

Product 테이블
![minandmax](../../../../assets/media/images/sql-004/minandmax00.png)
###### 출처 - https://www.w3schools.com/sql/sql_min_max.asp

MIN() Product 테이블에서 가장 가격이 싼 상품을 찾아보자.

```sql
SELECT MIN(Price) AS SmallestPrice
FROM Products;
```

MAX() Product 테이블에서 가장 가격이 비싼 상품을 찾아보자.

```sql
SELECT MAX(Price) AS LargestPrice
FROM Products;
```

<br><br><br><br>

**function : COUNT(), AVG(), SUM()** <br>
COUNT () : 지정된 기준과 일치하는 행 수를 반환합니다.<br>
AVG () : 숫자 컬럼의 평균값을 반환합니다.<br>
SUM () : 숫자 컬럼의 총 합계를 반환합니다.<br>

COUNT() 문법:

```sql
SELECT COUNT(column_name)
FROM table_name
WHERE condition;
```

AVG() 문법:

```sql
SELECT AVG(column_name)
FROM table_name
WHERE condition;
```

SUM() 문법:

```sql
SELECT SUM(column_name)
FROM table_name
WHERE condition;
```

Product 테이블
![minandmax](../../../../assets/media/images/sql-004/minandmax00.png)
###### 출처 - https://www.w3schools.com/sql/sql_count_avg_sum.asp

COUNT() 를 이용해서 Product 테이블의 레코드 수를 리턴해보자.

```sql
SELECT COUNT(ProductID)
FROM Products;
```

AVG() 를 이용해서 Product 테이블 안에 price 컬럼의 평균 값을 리턴해보자.

```sql
SELECT AVG(price)
FROM Products;
```

OrderDetails 테이블
![minandmax](../../../../assets/media/images/sql-004/sql_count_avg_sum00.png)
###### 출처 - https://www.w3schools.com/sql/sql_count_avg_sum.asp

SUM() 을 이용해서 OrderDetails 테이블 안에 Quantity 컬럼의 모두 더한 값을 리턴해보자.

```sql
SELECT SUM(Quantity)
FROM OrderDetails;
```



